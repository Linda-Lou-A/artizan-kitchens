<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/jpg" href="./images/favicon.jpg">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
   <link href="./dist/output.css" rel="stylesheet">
      <title>Artizan Kitchens | Designing Your Dream Kitchen in Spain</title>
      
    
    <!-- Calendar Specific Styles (Embedded for single-file structure) -->
    <style>
        :root {
    --artizan-blue: #0079AB;
    --artizan-yellow: #FFC82D; /* Custom Yellow/Orange */
}

.text-artizan-blue { color: var(--artizan-blue); }
.bg-artizan-blue { background-color: var(--artizan-blue); }
.bg-artizan-yellow { background-color: var(--artizan-yellow); }

/* Custom Hover for CTA Button */
.cta-button:hover {
    background-color: #e5b428; /* Slightly darker shade of the yellow for hover */
}
        /* MODAL BASE STYLES */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.6); 
            padding-top: 50px;
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto; 
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            max-width: 95%; 
            width: 750px; 
            position: relative;
        }
        .close-modal {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }
        .close-modal:hover,
        .close-modal:focus {
            color: #0079AB;
            text-decoration: none;
        }
        
        /* MESSAGE MODAL (For errors/success/init) */
        #message-modal {
            position: fixed;
            bottom: 20px;
            right: 20px;
            color: white;
            padding: 15px 25px;
            border-radius: 5px;
            z-index: 1001;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            display: none;
            font-weight: 700;
        }
        
        /* --- RESPONSIVE BUTTON VISIBILITY --- */
        /* By default (mobile size), hide the desktop link and show the mobile wrapper */
        header .cta-desktop { display: none !important; }
        header .cta-wrapper-mobile { display: block !important; } 

        /* On desktop (min-width: 768px), hide mobile wrapper, show desktop button */
        @media (min-width: 768px) {
            header .cta-desktop { display: inline-block !important; }
            header .cta-wrapper-mobile { display: none !important; }
        }
        
        /* CALENDAR TABLE STYLES - Mobile-Optimized Transposed View */
        .calendar-table {
            width: 100%; /* Fills modal space */
            border-collapse: collapse;
            margin-top: 20px;
            font-family: 'Lato', sans-serif;
            text-align: center;
        }
        .calendar-table th, .calendar-table td {
            border: 1px solid #ddd;
            padding: 5px 2px; /* Reduced padding for space */
            font-size: 13px;
            white-space: nowrap; /* Prevent time slots from wrapping */
        }
        
        /* New Time Header (formerly Date Header style) */
        .calendar-time-header {
            background-color: #f8f8f8;
            font-weight: 700;
            color: #0079AB;
            text-transform: uppercase;
        }

        /* New Date Label (runs down the side) */
        .date-label {
            background-color: #f0f0f0;
            font-weight: 700;
            text-align: left; /* Align date label left */
            padding-left: 10px !important;
            color: #333;
        }
        .date-label span {
            display: inline-block;
            font-size: 1.1em;
            margin-left: 5px;
            color: #0079AB;
        }

        .slot-cell {
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
        }

        /* Availability Styling */
        .slot-cell.available {
            background-color: #E6F7FF; 
            color: #0079AB; 
            font-weight: 400; 
        }
        .slot-cell.available:hover {
            background-color: #0079AB;
            color: white;
        }
        .slot-cell.booked {
            background-color: #f44336; 
            color: white;
            cursor: not-allowed;
            font-weight: 400;
            opacity: 0.7;
        }

        /* Responsive adjustments for modal and calendar */
        .calendar-responsive-wrapper {
            overflow-x: auto; /* Allow horizontal scroll for small screens */
            padding-bottom: 0; 
        }

        /* --- LAYOUT FIXES FOR DESKTOP/TABLET --- */
        
        /* Trust Icons Container */
        .trust-icons-section .container { 
            display: flex; 
            justify-content: space-between; 
            text-align: center; 
            padding: 0 10px; 
        }
        /* Trust Icon Cards - Ensures three fit in a row */
        .feature-card { 
            /* Calculation ensures 3 cards fit with margins */
            flex-basis: calc(33.33% - 20px); 
            margin: 0 10px; 
            padding: 20px; background: #fff; border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.05); 
        }
        .feature-card h3 { color: #0079AB; font-family: 'Montserrat', sans-serif; }
/* Trust Icon Cards - Extra padding for the very top of the first card */
.trust-icons-section .feature-card:first-child {
    padding-top: 25px; /* Increased from 20px to 30px (adds 10px of space above h3) */
}
        /* Process Steps Container */
        .process-steps { 
            display: flex; 
            justify-content: space-between; 
            margin-top: 40px; 
            padding: 0 10px; 
        }
        /* Process Step Cards - Ensures three fit in a row */
        .step { 
            /* Calculation ensures 3 steps fit with margins */
            flex-basis: calc(33.33% - 20px); 
            min-width: 250px; 
            margin: 0 10px; 
            padding: 20px; border-radius: 8px; 
            background: #fff; box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
        }
        .step span { 
            display: block; font-size: 1.5em; font-weight: 800; color: #FFC82D; 
            margin-bottom: 5px; 
        }
        .step h3 { color: #0079AB; font-family: 'Montserrat', sans-serif; }
/* === Custom Styling for the Navigation CTA Button === */
   /* === Custom Styling for the Navigation CTA Button (CORRECTED YELLOW) === */
    .nav-cta {
        /* Primary Artizan Yellow */
        background-color: #FFC82D;
        color: #333 !important; /* Force dark text for readability on light yellow */
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }
    .nav-cta:hover {
        /* Darker Yellow/Gold for Hover Effect */
        background-color: #EAB308;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05); /* Enhanced shadow on hover */
    }
/* === FIX: Precise Desktop Navigation Spacing (1.6cm & 2cm) === */

/* Sets the 1.6cm margin for the first list item (Home) relative to the Logo. */
/* We set a large negative margin to counteract any default padding/margin on the NAV/UL */
.desktop-nav-spacing-list li:first-child {
    margin-left: -26.1cm !important; 
}

/* Set the 2cm margin between all subsequent menu items */
.desktop-nav-spacing-list li:not(:first-child) {
    margin-left: 1.2cm !important;
}

/* Ensure the CTA button is correctly aligned and has the 2cm gap */
.desktop-nav-spacing-list li:last-child {
    /* Ensures the CTA link starts 2cm after the Contact link */
    margin-left: 2.2cm !important; 
}
/* FINAL, NUCLEAR OVERLAP FIX (Cleaned of conflicting rules) */
.hero-image-full-cover {
    width: 100% !important; 
    
    /* CRITICAL: Force image to be 4px taller than container */
    height: calc(100% + 4px) !important; 
    
    /* CRITICAL: Shift the image up by 2px (half the overlap) to hide the bottom artifact */
    margin-top: -2px !important; 
    
    /* ESSENTIAL: Must be block to eliminate baseline gap */
    display: block !important; 
    
    /* Cleanup rules */
    margin-left: 0 !important;
    
    /* The incorrect vertical-align rule has been REMOVED */
}
        /* Mobile Adjustments (Below 768px) */
        @media (max-width: 768px) {
            .modal-content {
                margin: 20px auto; width: 95%; padding: 15px;
            }
            /* Custom fix: Only applies top padding to the image on mobile screens */

    }
            .calendar-table th, .calendar-table td {
                min-width: 60px; padding: 4px 1px; font-size: 12px; 
            }
            .date-label { min-width: 80px; }
            
            /* Mobile: Stack Trust Icons */
            .trust-icons-section .container { flex-direction: column; padding: 0; }
            .feature-card { flex-basis: 100%; margin: 10px 0; }
            
            /* Mobile: Stack Process Steps */
            .process-steps { flex-direction: column; padding: 0;}
            .step { flex-basis: 100%; margin: 10px 0; }

            /* Header adjustments for mobile */
            header { flex-wrap: wrap; justify-content: center; }
            .logo { order: 1; width: 100%; text-align: center; margin-bottom: 10px; padding-left: 0; }
            nav { order: 3; width: 100%; }
            nav ul { flex-direction: column; text-align: center; }
            nav li a { padding: 5px 15px; border-top: 1px solid #eee; }
            .cta-wrapper-mobile { order: 2; margin-bottom: 10px;}
/* --- Desktop/Base Styles --- */
/* Override fixed height and use padding for the blue background container (#home) */
#home {
    /* Sets the default desktop height, allowing text, image, and padding */
    padding-top: 4rem !important; 
    padding-bottom: 28rem !important; /* Ensures the blue background extends far enough for desktop image */
}
/* BASE STYLES for image wrapper - Applies to ALL VIEWPORTS (Desktop, Mobile, etc.) */
/* BASE STYLES for image wrapper - Applies to ALL VIEWPORTS (Desktop, Mobile, etc.) */
.hero-style {
    bottom: auto !important;
    /* REMOVE THIS LINE: display: block !important; */
}


/* 1. Standard Mobile Fix (Targeting standard phones 421px to 768px) */
@media (max-width: 768px) {
    /* Ensure the section is tall enough for the image on standard mobile */
    #home {
        padding-bottom: 29rem !important; /* ~480px of space below the content */
    }
    
    /* Position image for standard mobiles/tablets */
    .hero-style {
        top: 350px !important; /* Pushes image down below standard mobile text block */
        width: 95% !important; 
        max-width: 95% !important; 
    }
}

/* 2. CRITICAL FIX for Galaxy Z Fold 5 (Ultra-Narrow Screens below 420px) */
@media (max-width: 420px) {
    /* CRITICAL: Aggressively increase the section height (padding-bottom) for Z Fold */
    #home {
        padding-bottom: 29rem !important; /* ~720px of space: Must be tall enough to contain top: 650px */
    }
    
    /* CRITICAL: Push the absolutely positioned image wrapper way down to clear the tall text/CTA */
    .hero-style {
        /* CRITICAL: Aggressive vertical push to clear the wrapped text. */
        top: 450px !important; 
        width: 95% !important; 
        max-width: 400px !important; 
    }
}
        /* --- BASIC PAGE LAYOUT STYLES (Kept for completeness) --- */
        /* --- body { margin: 0; font-family: 'Lato', sans-serif; color: #333; background-color: #f9f9f9; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        /* Header */
        /* --- header { background-color: #fff; padding: 15px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        .logo a { font-family: 'Montserrat', sans-serif; font-size: 1.8em; font-weight: 800; color: #0079AB; text-decoration: none; padding-left: 20px; }
        nav ul { list-style: none; margin: 0; padding: 0; display: flex; }
        nav li a { text-decoration: none; color: #333; padding: 10px 15px; display: block; transition: color 0.2s; }
        nav li a:hover { color: #0079AB; } --- */ /* Blue hover for navigation links */
        
        /* --- COLOR & BUTTON UPDATES --- */
        
        /* Primary CTA Buttons (RAL 1003 / Warm Yellow) */
        .cta-button, .btn-primary, .primary-cta-btn {
            padding: 12px 25px; /* Slightly larger padding */
            text-decoration: none;
            border-radius: 25px;
            font-weight: 700;
            transition: background-color 0.3s, transform 0.1s, box-shadow 0.3s;
            text-align: center;
            display: inline-block;
            cursor: pointer;
            border: 2px solid transparent;
            
            background-color: #FFC82D; /* Warm Yellow */
            color: #333;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .cta-button:hover, .btn-primary:hover, .primary-cta-btn:hover {
            background-color: #E0B426; /* Darker hover state for new yellow */
            transform: translateY(-2px); /* Lift a bit more */
            box-shadow: 0 8px 10px rgba(0, 0, 0, 0.2);
        }
        
        /* Secondary CTA Button (for 'View All Kitchen Ranges') */
        .secondary-cta-btn {
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 700;
            transition: background-color 0.3s, transform 0.1s;
            display: inline-block;
            cursor: pointer;
            background-color: #ffffff;
            color: #333;
            border: 2px solid #0079AB; /* Explicit blue border */
            margin-top: 20px;
        }
        .secondary-cta-btn:hover {
            background-color: #0079ab; /* Blue hover for secondary button */
            color: white;
            transform: translateY(-1px);
        }

        /* Hero Section */
.hero-section { background: url('https://placehold.co/1200x600/0079AB') no-repeat center center/cover; color: white; padding: 100px 20px; text-align: center; }
        .hero-content { max-width: 800px; margin: 0 auto; background-color: rgba(0, 0, 0, 0.5); padding: 30px; border-radius: 8px; }
        .hero-content h1 { font-family: 'Montserrat', sans-serif; font-size: clamp(1.8em, 5vw, 2.5em); margin-bottom: 10px; }
        .hero-content p { font-size: clamp(1em, 3vw, 1.2em); margin-bottom: 30px; }
        /* Trust Icons */
        .trust-icons-section { padding: 40px 20px; background-color: #f0f0f0; }
        
        /* Kitchen Preview */
        .kitchen-preview-section { text-align: center; padding: 60px 20px; }
        .kitchen-preview-section h2 {
            border-bottom: 3px solid #FFC82D; /* Yellow underline */
            display: inline-block; 
            padding-bottom: 5px; 
            margin-bottom: 10px;
            font-family: 'Montserrat', sans-serif;
        }
        .kitchen-gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 30px 0; }
        .range-card { text-decoration: none; color: #333; background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 8px rgba(0,0,0,0.1); transition: transform 0.3s; }
        .range-card:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0,0,0,0.2); }
        .range-card img { width: 100%; height: 250px; object-fit: cover; }
        .range-card h3 { padding: 15px; margin: 0; color: #0079AB; font-family: 'Montserrat', sans-serif; }
        
        /* Process Section */
        .process-section { padding: 60px 20px; text-align: center; background-color: #E6F7FF; }
        .underlined-heading { border-bottom: 3px solid #FFC82D; /* Yellow underline for process heading */ display: inline-block; padding-bottom: 5px; margin-bottom: 10px; font-family: 'Montserrat', sans-serif; }
        
        /* Final CTA Section (Blue Background as requested) */
        .final-cta-section { 
            background-color: #0079AB; /* Artizan Blue */
            color: white; 
            text-align: center; 
            padding: 60px 20px; 
        }
        .final-cta-section h2 { font-family: 'Montserrat', sans-serif; font-size: clamp(1.5em, 5vw, 2em); margin-bottom: 10px; }
        .final-cta-section p { margin-bottom: 30px; }
        
        /* Footer */
        footer { background-color: #333; color: #ccc; padding: 40px 20px; text-align: center; font-size: 0.9em; }
        .footer-links ul { list-style: none; padding: 0; display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; }
        .footer-links a { color: #ccc; text-decoration: none; transition: color 0.2s; }
        .footer-links a:hover { color: #FFC82D; } /* Using yellow for footer link hover */
        .contact-info p { margin: 5px 0; }
        .copyright { margin-top: 20px; border-top: 1px solid #555; padding-top: 15px; }

    </style>
 <!-- Firestore & Firebase Imports -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, query, where, onSnapshot, addDoc, serverTimestamp, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- GLOBAL VARIABLES & PROMISE TRACKER ---
        let db, auth, userId = null;
        let isFirebaseReady = false; 
        let BOOKINGS_COLLECTION_PATH = null;
        let initPromise = null; 

        // Utility to convert Date to YYYY-MM-DD string
        const formatDate = (date) => date.toISOString().split('T')[0];

        // Core Initialization Logic - Returns a promise
        const initFirebase = async () => {
            try {
                // 1. SAFELY READ AND VALIDATE GLOBAL CONFIG VARIABLES
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                let firebaseConfig;
                const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                
                // CRITICAL: Ensure Firebase config is present
                if (typeof __firebase_config !== 'undefined' && __firebase_config && __firebase_config.trim().length > 0) {
                    firebaseConfig = JSON.parse(__firebase_config);
                } else {
                    // In a live environment, this config is MANDATORY. Throw an error if missing.
                    throw new Error("Firebase configuration (__firebase_config) is missing.");
                }
                
                // --- THIS IS THE LIVE BOOKINGS COLLECTION PATH ---
                BOOKINGS_COLLECTION_PATH = `/artifacts/${appId}/public/data/bookings`;
                
                // 2. Initialize App
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // 3. Authentication Attempt
                let userCredential;
                if (initialAuthToken) {
                    // Use custom token if provided
                    userCredential = await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    // Fall back to anonymous sign-in
                    userCredential = await signInAnonymously(auth);
                }
                userId = userCredential.user.uid; 
                /* Custom Colors */
                // 4. Set Ready Flag and Start Listener
                isFirebaseReady = true; 
                listenForBookings();
                
                return true; // Resolve the promise successfully
                
            } catch (error) {
                console.error("Critical Initialization Error:", error);
                // Propagate error to handleBookingClick for UI display
                throw new Error("Failed to connect to the live booking system.");
            }
        };

        // --- BOOKING LOGIC AND STATE ---
        const timeSlots = ["10:00", "11:00", "12:00", "13:00"]; 

        const listenForBookings = () => {
            if (!db || !BOOKINGS_COLLECTION_PATH) return; 
            
            const bookingsRef = collection(db, BOOKINGS_COLLECTION_PATH);
            
            // Listen to the live database for changes
            onSnapshot(bookingsRef, (snapshot) => {
                const liveBookedSlots = new Set();
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    const slotKey = `${data.date} ${data.time}`;
                    liveBookedSlots.add(slotKey);
                });
                renderCalendar(liveBookedSlots);
            }, (error) => {
                console.error("Error listening to bookings:", error);
                showErrorMessage("Live booking data failed to load. Please refresh the page.");
                renderCalendar(new Set()); // Fallback to an empty calendar on error
            });
        };

        const getDatesForCalendar = () => {
            const dates = [];
            let currentDate = new Date();
            currentDate.setHours(0, 0, 0, 0); 

            while (dates.length < 10) {
                const dayOfWeek = currentDate.getDay(); 
                // Only Monday (1) to Friday (5)
                if (dayOfWeek >= 1 && dayOfWeek <= 5) {
                    dates.push(new Date(currentDate));
                }
                currentDate.setDate(currentDate.getDate() + 1); 
            }
            return dates;
        };

        const renderCalendar = (bookedSlots) => {
            const calendarBody = document.getElementById('calendar-body');
            if (!calendarBody) return;
            
            calendarBody.innerHTML = ''; 
            const dates = getDatesForCalendar();
            
            // HEADER: Time slots across the top (5 columns total)
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = '<th class="date-label">Date</th>' + timeSlots.map(time => {
                return `<th class="calendar-time-header">${time}</th>`;
            }).join('');
            calendarBody.appendChild(headerRow);
            
            // BODY: Dates become rows
            dates.forEach(date => {
                const row = document.createElement('tr');
                const dateStr = formatDate(date);
                const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
                const dateNum = date.getDate();
                
                // First cell is the Date label (e.g., Mon 14)
                row.innerHTML = `<td class="date-label">${dayName} <span>${dateNum}</span></td>`;
                
                timeSlots.forEach(time => {
                    const slotKey = `${dateStr} ${time}`;
                    const isBooked = bookedSlots.has(slotKey);
                    
                    const cell = document.createElement('td');
                    cell.className = 'slot-cell';
                    
                    if (isBooked) {
                        cell.classList.add('booked');
                        cell.textContent = 'Booked';
                    } else {
                        cell.classList.add('available');
                        cell.textContent = 'Select'; 
                        cell.dataset.date = dateStr;
                        cell.dataset.time = time;
                        cell.addEventListener('click', handleSlotClick);
                    }
                    row.appendChild(cell);
                });
                calendarBody.appendChild(row);
            });
        };

        const handleSlotClick = (event) => {
            const dateStr = event.target.dataset.date;
            const timeStr = event.target.dataset.time;
            
            showConfirmationModal(dateStr, timeStr);
        };

        const bookSlot = async (date, time, clientName) => {
            if (!userId) {
                showErrorMessage("Booking failed: User not authenticated.");
                return;
            }

            const bookingsRef = collection(db, BOOKINGS_COLLECTION_PATH);
            
            try {
                // Check if the slot is still available (critical race condition check)
                const q = query(bookingsRef, where("date", "==", date), where("time", "==", time));
                const snapshot = await getDocs(q);

                if (snapshot.empty) {
                    // Slot is available, proceed with booking
                    await addDoc(bookingsRef, {
                        date: date,
                        time: time,
                        userId: userId,
                          clientName: clientName, // SAVING THE NEW FIELD
                          //                         timestamp: serverTimestamp()
                    });
                    
                    // The onSnapshot listener will automatically update the calendar UI
                    showSuccessMessage(`Success! Your consultation on ${date} at ${time} is confirmed.`);

                } else {
                    showErrorMessage('Sorry, that slot was just booked by another user. Please select a different time.');
                }
            } catch (e) {
                console.error("Error booking slot:", e);
                showErrorMessage('An error occurred during booking. Please try again.');
            }
        };

        // --- MODAL AND MESSAGE HANDLING ---
        // Deferred assignment to wait for DOM to load, which happens when the script module executes.
        let calendarModal;
        let bookingInfo;
        let confirmBtn;
        let cancelBtn;
        let messageModal;
        let messageText;
        let clientNameInput; 
        
        let currentBookingDate = null;
        let currentBookingTime = null;
        
        // Function to initialize DOM elements after they are loaded
        const initializeDOMElements = () => {
            calendarModal = document.getElementById('calendar-modal');
            bookingInfo = document.getElementById('booking-info');
            confirmBtn = document.getElementById('confirm-booking-btn');
            cancelBtn = document.getElementById('cancel-booking-btn'); 
            messageModal = document.getElementById('message-modal');
            messageText = document.getElementById('message-text');
            clientNameInput = document.getElementById('client-name-input'); // INITIALIZING NEW INPUT
            

            // Add event listeners once elements are found
            document.querySelectorAll('.open-calendar-modal').forEach(button => {
                button.addEventListener('click', handleBookingClick);
            });
            document.querySelectorAll('.close-modal').forEach(span => {
                span.addEventListener('click', (e) => {
                    const modalId = e.target.closest('.modal').id;
                    if (modalId === 'calendar-modal') closeCalendarModal();
                    if (modalId === 'confirmation-modal') closeConfirmationModal();
                });
            });
            window.addEventListener('click', (event) => {
                if (event.target === calendarModal) closeCalendarModal();
                if (event.target === document.getElementById('confirmation-modal')) closeConfirmationModal();
            });
            // UPDATED CONFIRM BUTTON HANDLER
            if (confirmBtn) {
                confirmBtn.addEventListener('click', () => {
                    // 1. Get the client name and trim whitespace
                    const clientName = clientNameInput.value.trim();
                    
                    // 2. Validate: Check if the name is empty
                    if (!clientName) {
                        showErrorMessage("Please enter your full name before confirming the booking.");
                        return; // Stop if name is empty
                    }
                    
                    if (currentBookingDate && currentBookingTime) {
                        // 3. Pass the clientName to the booking function
                        bookSlot(currentBookingDate, currentBookingTime, clientName); 
                    }
                });
            }
        };

        const handleBookingClick = async (e) => {
            e.preventDefault(); 
            
            if (isFirebaseReady) {
                calendarModal.style.display = 'block';
                return;
            }

            // 1. Show initializing message instantly
            messageText.textContent = "Connecting to the live booking system...";
            messageModal.style.backgroundColor = '#FFC82D'; /* Warm Yellow for initialization */
            messageModal.style.display = 'block';

            try {
                // 2. Start initialization promise only once
                if (!initPromise) {
                    initPromise = initFirebase();
                }
                
                // 3. Wait for the connection to succeed
                await initPromise; 
                
                // 4. Success: Hide message
                messageModal.style.display = 'none';

                // 5. Open calendar
                if (isFirebaseReady) {
                    calendarModal.style.display = 'block'; 
                }

            } catch (error) {
                // 6. Failure: Hide message and show error
                messageModal.style.display = 'none';
                showErrorMessage("Booking system connection failed. Please check your network or try again.");
            }
        };


        const closeCalendarModal = () => {
            if(calendarModal) calendarModal.style.display = 'none';
        };

        const showConfirmationModal = (dateStr, timeStr) => {
            currentBookingDate = dateStr;
            currentBookingTime = timeStr;
            if (bookingInfo) bookingInfo.textContent = `${dateStr} at ${timeStr}`;
            const confModal = document.getElementById('confirmation-modal');
            if (confModal) confModal.style.display = 'block';
        };

        const closeConfirmationModal = () => {
            const confModal = document.getElementById('confirmation-modal');
            if (confModal) confModal.style.display = 'none';
        };

        const showSuccessMessage = (message) => {
            closeCalendarModal();
            closeConfirmationModal();
            if (messageText) messageText.textContent = message;
            if (messageModal) {
                messageModal.style.backgroundColor = '#4CAF50'; 
                messageModal.style.display = 'block';
                setTimeout(() => { messageModal.style.display = 'none'; }, 5000);
            }
        };

        const showErrorMessage = (message) => {
            closeConfirmationModal();
            if (messageText) messageText.textContent = message;
            if (messageModal) {
                messageModal.style.backgroundColor = '#f44336'; 
                messageModal.style.display = 'block';
                setTimeout(() => { messageModal.style.display = 'none'; }, 5000);
            }
        };
        
        // Run DOM initialization once the document is ready
        window.addEventListener('DOMContentLoaded', initializeDOMElements);
    </script>   
</head>
<body>

    <!-- SUCCESS/ERROR MESSAGE MODAL -->
    <div id="message-modal">
        <span id="message-text"></span>
    </div>

    <!-- CALENDAR BOOKING MODAL -->
    <div id="calendar-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Book Your Free Design Consultation</h2>
            <p>Select an available 1-hour time slot between Monday and Friday for your initial consultation.</p>
            
            <div class="calendar-responsive-wrapper">
                <table class="calendar-table">
                    <tbody id="calendar-body">
                        <!-- Calendar content will be generated here by JavaScript -->
                        <tr><td>Connecting to Live System...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <p style="margin-top: 20px; font-size: 0.9em; color: #666;">
                <span style="font-weight: bold; color: #f44336;">Note on Notifications:</span> In a live deployment, booking this slot would automatically trigger an email to the business and a WhatsApp message to the owner for immediate logging.
            </p>
        </div>
    </div>

    <!-- CONFIRMATION MODAL -->
    <div id="confirmation-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <span class="close-modal">&times;</span>
            <h3>Confirm Booking</h3>
            <div style="margin-bottom: 20px;">
    <label for="client-name-input" style="display: block; font-weight: 600; margin-bottom: 5px; color: #333;">Your Full Name:</label>
    <input type="text" id="client-name-input" placeholder="Enter your name" 
           style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
</div>
            <p>Are you sure you want to book a consultation on:</p>
            <p style="font-size: 1.2em; font-weight: bold; color: #0079AB;" id="booking-info">DATE at TIME</p>
            <button id="confirm-booking-btn" class="cta-button" style="margin-right: 10px; border: none;">Confirm Booking</button>
            <button id="cancel-booking-btn" class="secondary-cta-btn" style="margin-top: 0; margin-left: 10px;">Cancel</button>
        </div>
    </div>
<!-- Header and Navigation (FINAL WORKING STRUCTURE) -->
<header id="main-header" class="bg-white sticky top-0 z-10 shadow-md border-b border-gray-300">
    
    <!-- Main Header Container: Logo Left, Nav Right -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-16">
        
        <!-- Logo -->
        <a href="index.html" class="text-[#0079AB] font-extrabold text-xl md:text-2xl whitespace-nowrap">Artizan Kitchens</a>

        <!-- Desktop Navigation: Hidden on mobile, forced horizontal (md:flex) -->
        <nav class="hidden md:flex items-center w-full justify-end">
            
            <!-- Navigation List: Customized spacing using desktop-nav-spacing-list -->
<ul class="flex flex-row list-none p-0 m-0 items-center desktop-nav-spacing-list">
    <li><a href="index.html" class="font-bold transition duration-300 text-[#333] hover:text-[#0079AB]">Home</a></li>
    <li><a href="about.html" class="font-bold transition duration-300 text-[#333] hover:text-[#0079AB]">About</a></li>
    <li><a href="kitchens.html" class="font-bold transition duration-300 text-[#333] hover:text-[#0079AB]">Kitchens</a></li>
    <li><a href="bedrooms.html" class="font-bold transition duration-300 text-[#333] hover:text-[#0079AB]">Bedrooms</a></li>
    <li><a href="testimonials.html" class="font-bold transition duration-300 text-[#333] hover:text-[#0079AB]">Testimonials</a></li>
    <li><a href="contact.html" class="font-bold transition duration-300 text-[#333] hover:text-[#0079AB]">Contact</a></li>
    
    
</ul>
        </nav>

        <!-- Mobile Menu Button (Hamburger Icon) -->
        <button id="mobile-menu-button" class="md:hidden text-gray-500 hover:text-[#0079AB]">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
        </button>
    </div>

    <!-- Mobile Menu Container (This menu will stack vertically) -->
    <div id="mobile-menu" class="hidden md:hidden w-full bg-white border-t border-gray-100 shadow-lg">
        <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 flex flex-col items-center">
            <a href="index.html" class="block w-full text-center py-2 text-[#333] hover:bg-gray-100 font-bold">Home</a>
            <a href="about.html" class="block w-full text-center py-2 text-[#333] hover:bg-gray-100 font-bold">About</a>
            <a href="kitchens.html" class="block w-full text-center py-2 text-[#333] hover:bg-gray-100 font-bold">Kitchens</a>
            <a href="bedrooms.html" class="block w-full text-center py-2 text-[#333] hover:bg-gray-100 font-bold">Bedrooms</a>
            <a href="testimonials.html" class="block w-full text-center py-2 text-[#333] hover:bg-gray-100 font-bold">Testimonials</a>
            <a href="contact.html" class="block w-full text-center py-2 text-[#333] hover:bg-gray-100 font-bold">Contact</a>
            <a href="contact.html" class="block w-3/4 text-center my-3 py-2 bg-yellow-500 text-white font-bold rounded-lg hover:bg-yellow-600">Book a Design Consultation</a>
        </div>
    </div>

    <script>
        // JavaScript to handle the mobile menu toggle
        const menuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        if (menuButton && mobileMenu) {
            menuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }
    </script>
</header>
<!-- YOUR MAIN CONTENT STARTS DIRECTLY BELOW THIS LINE, USUALLY WITH <main> -->
    <main>
        <!-- Logo Placed ABOVE Hero Section (Centered) -->
<section style="padding: 20px 0; background-color: #ffffff;">
    <div class="container" style="text-align: center;">
        <!-- NOTE: The size (height: 80px) is just a suggestion. Adjust as needed! -->
        <img src="./images/logo.jpg" 
             alt="Artizan Kitchens Logo" 
             style="height: 100px; width: auto; display: block; margin: 0 auto;">
    </div>
</section>
<!-- Hero Section - FULL WIDTH BLUE BACKGROUND CONTAINER -->
<section id="home" class="w-full text-white relative pt-16 pb-[20rem] sm:pb-[20rem]"
         style="background-color: #0079AB;">
    
    <!-- 1. Text Content (Centered, Constrained Width) -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-40"> 
    <h1 class="text-4xl font-extrabold tracking-tight mb-4">
        Bespoke Kitchen, Bedroom & Bathroom Design - Built Around You
    </h1>
    
    <p class="mt-4 text-xl font-light max-w-3xl mx-auto">
        From initial concept to final installation, Artizan Kitchens crafts spaces that are beautiful, functional, and uniquely yours.
    </p>
    <div class="mt-2 flex justify-center">
        <a href="#" class="cta-button open-calendar-modal px-8 py-3 text-lg font-medium rounded-full text-gray-900 bg-artizan-yellow transition duration-300 transform hover:scale-105 shadow-xl">
            Book Your Free Design Consultation
        </a>
    </div>
</div>
   <div class="absolute hero-style h-[400px] overflow-hidden 
bg-white rounded-xl border-b-8 border-artizan-blue shadow-xl" 
style="width: 90%; max-width: 1000px; left: 50%; transform: translateX(-50%); top: 250px;">
    
    <img src="./images/hero-kitchen.jpg" alt="Beautiful bespoke Artizan kitchen" 
  class="object-cover hero-image-full-cover" 
   onerror="this.onerror=null; this.src='https://placehold.co/1000x500/ffffff/333333?text=Bespoke+Kitchen+Image';">
</div>
</section>
   <section class="trust-icons-section">
            <div class="container">
                <article class="feature-card">
                    <h3>Price Match Promise</h3>
                    <p>We guarantee to match any like-for-like quote, ensuring you get the best value for your dream kitchen.</p>
                </article>
                <article class="feature-card">
                    <h3>3D Technology</h3>
                    <p>See the finished kitchen in your actual property before any work begins.</p>
                </article>
                <article class="feature-card">
                    <h3>Local & Reliable</h3>
                    <p>Based in Vera, Almería, we manage the entire project, ensuring a stress-free install.</p>
                </article>
            </div>
        </section>
 <!-- Kitchen Preview -->
<section class="kitchen-preview-section" id="kitchens" style="padding: 25px 20px 20px;">
    <!-- Headings Color Fix 1: Kitchen Preview -->
    <h2 style="border-bottom-color: #FFC82D !important;">Explore our most popular kitchen ranges</h2>
    <div class="kitchen-gallery-grid">
        
       <!-- MODERN KITCHENS (Link updated to anchor) -->
                    <a href="kitchens.html#modern" class="range-card">
                        <img src="./images/range-modern.jpg?v=grid_v2" alt="Modern Kitchen Range" loading="lazy">
                        <h3>Modern Kitchens</h3>
                    </a>
                    
                    <!-- SHAKER KITCHENS (Link updated to anchor) -->
                    <a href="kitchens.html#shaker" class="range-card">
                        <img src="./images/range-shaker.jpg?v=grid_v2" alt="Shaker Kitchen Range" loading="lazy">
                        <h3>Shaker Kitchens</h3>
                    </a>
                    
                    <!-- TRADITIONAL KITCHENS (Link updated to anchor) -->
                    <a href="kitchens.html#traditional" class="range-card">
                        <img src="./images/range-traditional.jpg?v=grid_v20241014" alt="Traditional Kitchen Range" loading="lazy">
                        <h3>Traditional Kitchens</h3>
                    </a>

    </div>
    <a href="kitchens.html" class="secondary-cta-btn">View All Kitchen Ranges</a>
</section>
       <section class="process-section" id="process-steps" style="padding-top: 12px;">
            <div class="container">
                <h2 class="underlined-heading">The Artizan Kitchens Process - How it works</h2>
                <p class="process-subtitle">Vision to Reality - Your Design Journey</p>
                <div class="process-steps">
                    <div class="step">
                        <span>1</span>
                        <h3>Design Consultation</h3>
                        <p>We discuss your vision, budget, and lifestyle requirements.</p>
                    </div>
                    <div class="step">
                        <span>2</span>
                        <h3>3D Digital Preview</h3>
                        <p>We use state-of-the-art software to generate a visual image of your new kitchen in your home.</p>
                    </div>
                    <div class="step">
                        <span>3</span>
                        <h3>Installation & Finish</h3>
                        <p>Our experienced team installs your kitchen efficiently and professionally.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="final-cta-section" style="padding-top: 18px;">
            <div class="container">
                <h2>Ready to Start Your Home Transformation?</h2>
                <p>Talk to our expert design team today about your property in Almería.</p>
                <!-- This button is intended to be visible on all sizes -->
                <a href="#" class="primary-cta-btn open-calendar-modal">Get Your Free No-Obligation Quotation</a>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-links">
                <ul>
                    <li><a href="testimonials.html">Reviews</a></li>
                    <li><a href="contact.html">Contact Us</a></li>
                    <li><a href="privacy-policy.html">Privacy Policy</a></li>
                    <li><a href="terms.html">Terms of Use</a></li> 
                </ul>
            </div>
            <div class="contact-info">
                <p>Artizan Kitchens | Vera, Almería Spain</p>
                <p>Email: artizan4@yahoo.co.uk | Phone: +34 950 390 635 / 661 985 310</p>
            </div>
            <p class="copyright">&copy; 2025 Artizan Kitchens. All rights reserved.</p>
        </div>
    </footer>
    <!-- COOKIE CONSENT MODAL/BANNER -->
    <div id="cookie-consent-modal" class="fixed inset-x-0 bottom-0 z-50 p-4 transition-transform duration-500 transform translate-y-full">
        <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-2xl border-t-4 border-artizan-blue p-6 md:flex md:items-center md:justify-between space-y-4 md:space-y-0">
            
            <!-- Standard Consent View -->
            <div id="consent-view-main" class="w-full flex flex-col md:flex-row md:items-center justify-between">
                <p class="text-gray-700 text-sm md:text-base md:mr-6">
                    We use cookies to enhance your browsing experience. By clicking "Accept All", you consent to the use of all cookies. You can manage your preferences at any time.
                    <a href="privacy.html" class="text-artizan-blue hover:underline font-medium ml-1 whitespace-nowrap">Read our policy.</a>
                </p>
                
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 mt-4 md:mt-0 flex-shrink-0">
                    <button onclick="declineCookies()" class="px-4 py-2 text-sm font-semibold rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition duration-150">
                        Decline All
                    </button>
                    <button onclick="showModifySettings()" class="px-4 py-2 text-sm font-semibold rounded-lg text-artizan-blue hover:bg-artizan-blue hover:text-white transition duration-150 border border-artizan-blue">
                        Modify Settings
                    </button>
                    <button onclick="acceptCookies()" class="px-4 py-2 text-sm font-semibold rounded-lg bg-artizan-yellow text-gray-800 hover:bg-[#e5b428] transition duration-150">
                        Accept All
                    </button>
                </div>
            </div>

            <!-- Modify Settings View (Hidden by default) -->
            <div id="consent-view-modify" class="w-full hidden">
                <h3 class="text-xl font-bold text-artizan-blue mb-4 border-b pb-2">Cookie Preferences</h3>

                <div class="space-y-4 mb-6">
                    <!-- Essential Cookies -->
                    <label class="flex items-center space-x-3 cursor-not-allowed opacity-70">
                        <input type="checkbox" id="cookie-essential" name="cookie-essential" checked disabled class="h-5 w-5 rounded text-gray-400 bg-gray-100 border-gray-300">
                        <span class="text-base font-medium text-gray-900">Essential <span class="text-xs text-artizan-blue font-bold">(Always Active)</span></span>
                        <p class="text-sm text-gray-500 ml-auto">Required for basic site functionality.</p>
                    </label>

                    <!-- Analytical Cookies -->
                    <label class="flex items-center space-x-3 cursor-pointer">
                        <input type="checkbox" id="cookie-analytical" name="cookie-analytical" checked class="h-5 w-5 rounded text-artizan-blue focus:ring-artizan-blue border-gray-300">
                        <span class="text-base font-medium text-gray-900">Analytical</span>
                        <p class="text-sm text-gray-500 ml-auto">Helps us understand how the site is used.</p>
                    </label>

                    <!-- Marketing Cookies -->
                    <label class="flex items-center space-x-3 cursor-pointer">
                        <input type="checkbox" id="cookie-marketing" name="cookie-marketing" class="h-5 w-5 rounded text-artizan-blue focus:ring-artizan-blue border-gray-300">
                        <span class="text-base font-medium text-gray-900">Marketing</span>
                        <p class="text-sm text-gray-500 ml-auto">Used for personalized promotions.</p>
                    </label>
                </div>

                <div class="flex justify-end space-x-3">
                    <button onclick="showMainView()" class="px-4 py-2 text-sm font-semibold rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition duration-150">
                        Back
                    </button>
                    <button onclick="savePreferences()" class="px-4 py-2 text-sm font-semibold rounded-lg bg-artizan-blue text-white hover:bg-[#005f88] transition duration-150">
                        Save Preferences
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- END OF COOKIE CONSENT MODAL/BANNER -->

    <!-- START OF JAVASCRIPT: Place this script tag just before the closing </body> -->
    <script>
        // --- Cookie Consent Logic ---

        const CONSENT_KEY = 'artizan_cookie_consent';
        const modal = document.getElementById('cookie-consent-modal');
        const mainView = document.getElementById('consent-view-main');
        const modifyView = document.getElementById('consent-view-modify');
        
        const cookieTypes = ['analytical', 'marketing'];

        /** Checks localStorage on page load and shows the modal if no consent is found. */
        function checkConsentStatus() {
            const consent = localStorage.getItem(CONSENT_KEY);
            if (!consent) {
                // Show the modal by removing the 'translate-y-full' class
                modal.classList.remove('translate-y-full');
            } else {
                console.log('Cookie Consent Status:', consent);
            }
        }

        /** Sets the consent status in localStorage and hides the modal. */
        function setConsent(status, preferences = {}) {
            modal.classList.add('translate-y-full');
            
            let data = { status: status };
            if (status === 'custom') {
                data.preferences = preferences;
            }

            localStorage.setItem(CONSENT_KEY, JSON.stringify(data));
            console.log('Consent Updated:', data);
        }

        /** Handles the "Accept All" button click. */
        function acceptCookies() {
            const allPrefs = {};
            cookieTypes.forEach(type => allPrefs[type] = true);
            setConsent('accepted', allPrefs);
        }

        /** Handles the "Decline All" button click. */
        function declineCookies() {
            const noPrefs = {};
            cookieTypes.forEach(type => noPrefs[type] = false);
            setConsent('declined', noPrefs);
        }

        /** Switches the view to show the cookie modification settings. */
        function showModifySettings() {
            mainView.classList.add('hidden');
            modifyView.classList.remove('hidden');
            
            const consentData = JSON.parse(localStorage.getItem(CONSENT_KEY) || '{}');
            const prefs = consentData.preferences || {};
            
            document.getElementById('cookie-analytical').checked = prefs.analytical !== false;
            document.getElementById('cookie-marketing').checked = prefs.marketing === true;
        }

        /** Switches the view back to the main consent options. */
        function showMainView() {
            mainView.classList.remove('hidden');
            modifyView.classList.add('hidden');
        }

        /** Handles the "Save Preferences" button click from the modify view. */
        function savePreferences() {
            const preferences = {
                essential: true, 
                analytical: document.getElementById('cookie-analytical').checked,
                marketing: document.getElementById('cookie-marketing').checked,
            };
            
            const allAccepted = preferences.analytical && preferences.marketing;
            const allDeclined = !preferences.analytical && !preferences.marketing;

            if (allAccepted) {
                setConsent('accepted', preferences);
            } else if (allDeclined) {
                setConsent('declined', preferences);
            } else {
                setConsent('custom', preferences);
            }
            
            showMainView();
        }

        // Initialize the consent check once the DOM is fully loaded
        // This function must be placed AFTER the mobile menu toggle function if it exists.
        // It's called after all other window.onload tasks (like mobile menu toggle initialization).
        window.addEventListener('load', checkConsentStatus);

    </script>

</body>
</html>






















